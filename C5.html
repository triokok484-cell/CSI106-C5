<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luyện Tập: Computer Organization</title>
    
    <style>
        :root {
            --primary-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --light-bg-color: #f8f9fa;
            --border-color: #dee2e6;
            --text-color: #212529;
            --green-bg: #d4edda;
            --red-bg: #f8d7da;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        #app-container {
            background-color: white;
            padding: 1.5em 2em;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 800px;
            text-align: center;
        }

        h1, h2 { color: #0056b3; }
        .hidden { display: none; }

        /* --- Phần Lý Thuyết --- */
        #theory-section {
            margin-bottom: 2em;
            text-align: left;
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        #theory-section summary {
            font-size: 1.2em;
            font-weight: bold;
            padding: 15px;
            cursor: pointer;
            outline: none;
            color: var(--primary-color);
        }
        #theory-content {
            padding: 0 20px 20px 20px;
            line-height: 1.6;
        }
        #theory-content h3 {
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 5px;
            margin-top: 25px;
        }

        /* --- Phần Quiz --- */
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 5px;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }
        button:hover { background-color: #0056b3; }
        button:active { transform: scale(0.98); }
        button:disabled { background-color: #cccccc; cursor: not-allowed; }

        #quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        #progress-text { font-weight: bold; }

        #question-text {
            font-size: 1.25em;
            font-weight: bold;
            margin-bottom: 25px;
            line-height: 1.4;
            text-align: left;
        }

        .option {
            display: block;
            background-color: var(--light-bg-color);
            border: 2px solid var(--border-color);
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            text-align: left;
        }
        .option:hover { border-color: var(--primary-color); }
        
        #options-container.answered .option:not(.correct):not(.incorrect) {
            opacity: 0.6;
            pointer-events: none;
        }
        #options-container.answered .option:hover {
             border-color: var(--border-color); /* No hover effect after answer */
        }
        
        .option.correct {
            background-color: var(--green-bg);
            border-color: var(--success-color);
            color: var(--success-color);
            font-weight: bold;
            pointer-events: none;
        }
        .option.incorrect {
            background-color: var(--red-bg);
            border-color: var(--danger-color);
            color: var(--danger-color);
            font-weight: bold;
            pointer-events: none;
        }
        
        #feedback-container { text-align: left; margin-top: 20px; }
        .memory-tip {
            font-style: italic;
            color: #6c757d;
            background: #e9ecef;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border-left: 4px solid var(--primary-color);
        }

        #navigation-buttons button { margin-top: 15px; }
        #next-btn { background-color: var(--success-color); }
        #next-btn:hover { background-color: #218838; }

        /* --- Trang Kết Quả --- */
        #results-screen { text-align: left; }
        #score-text { font-size: 1.5em; font-weight: bold; text-align: center; margin-bottom: 20px; }
        .result-item {
            background: #fdfdff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .result-question { font-weight: bold; }
        .user-answer { padding-left: 15px; }
        .user-answer.correct { color: var(--success-color); }
        .user-answer.incorrect { color: var(--danger-color); text-decoration: line-through;}
        .correct-answer { color: var(--success-color); font-weight: bold; padding-left: 15px;}

    </style>
</head>
<body>
    <div id="app-container">
        <h1>Ôn Tập Chapter 5: Computer Organization</h1>

        <details id="theory-section">
            <summary>▶ Nhấn vào đây để xem lại tóm tắt lý thuyết</summary>
            <div id="theory-content">
                <p>Một máy tính được cấu thành từ ba hệ thống con cơ bản: <strong>Đơn vị Xử lý Trung tâm (CPU)</strong>, <strong>Bộ nhớ chính (Main Memory)</strong>, và <strong>Hệ thống Nhập/Xuất (I/O)</strong>.</p>
                <h3>1. CPU (Central Processing Unit)</h3>
                <ul>
                    <li>Được xem là "bộ não" của máy tính, có ba thành phần chính:
                        <ul>
                            <li><strong>ALU (Arithmetic Logic Unit):</strong> Thực hiện các phép toán số học (cộng, trừ) và logic (AND, OR, NOT).</li>
                            <li><strong>Control Unit (Khối Điều khiển):</strong> Điều phối và kiểm soát mọi hoạt động của máy tính.</li>
                            <li><strong>Registers (Thanh ghi):</strong> Vùng nhớ tạm thời tốc độ cực cao. Hai thanh ghi quan trọng là <strong>Program Counter (PC)</strong> (lưu địa chỉ lệnh kế tiếp) và <strong>Instruction Register (IR)</strong> (lưu lệnh đang thực thi).</li>
                        </ul>
                    </li>
                </ul>
                <h3>2. Bộ Nhớ Chính (Main Memory)</h3>
                <ul>
                    <li>Là nơi lưu trữ chương trình và dữ liệu mà CPU đang làm việc.</li>
                    <li><strong>RAM (Random Access Memory):</strong> Bộ nhớ đọc-ghi, dữ liệu sẽ <strong>mất khi ngắt điện</strong>. Gồm SRAM (nhanh) và DRAM (chậm hơn, cần làm mới).</li>
                    <li><strong>ROM (Read-Only Memory):</strong> Bộ nhớ chỉ đọc, <strong>không mất dữ liệu</strong> khi ngắt điện, thường chứa chương trình khởi động.</li>
                    <li><strong>Cache Memory:</strong> Bộ nhớ đệm siêu nhanh, nằm giữa CPU và RAM để tăng tốc độ truy cập.</li>
                </ul>
                <h3>3. Hệ Thống Nhập/Xuất (I/O)</h3>
                <ul>
                    <li>Giúp máy tính giao tiếp với thế giới bên ngoài.</li>
                    <li>Gồm các thiết bị lưu trữ (ổ đĩa từ, đĩa quang CD/DVD) và không lưu trữ (bàn phím, màn hình).</li>
                    <li>Kết nối qua <strong>Bus</strong> (Data, Address, Control) và các bộ điều khiển (Controllers) như USB.</li>
                </ul>
                <h3>4. Thực Thi Chương Trình và Kiến Trúc</h3>
                <ul>
                    <li>CPU thực thi theo <strong>Chu kỳ máy (Machine Cycle)</strong>: <strong>Fetch (Nạp)</strong> -> <strong>Decode (Giải mã)</strong> -> <strong>Execute (Thực thi)</strong>.</li>
                    <li><strong>Pipelining:</strong> Kỹ thuật xử lý gối đầu nhiều lệnh cùng lúc để tăng hiệu suất.</li>
                    <li><strong>Xử lý song song (Parallel Processing):</strong> Dùng nhiều đơn vị xử lý để thực hiện nhiều việc đồng thời.</li>
                </ul>
            </div>
        </details>

        <div id="quiz-container">
            <div id="start-screen">
                <h2>Chế độ Luyện tập</h2>
                <p>Chọn một đáp án để nhận phản hồi ngay lập tức. Bạn có thể nộp bài bất cứ lúc nào.</p>
                 <div id="quiz-options">
                    <button class="quiz-option-btn" data-count="10">10 Câu</button>
                    <button class="quiz-option-btn" data-count="25">25 Câu</button>
                    <button class="quiz-option-btn" data-count="50">50 Câu</button>
                    <button class="quiz-option-btn" data-count="100">Tất cả (100 Câu)</button>
                </div>
            </div>
    
            <div id="quiz-screen" class="hidden">
                <div id="quiz-header">
                    <p id="progress-text"></p>
                    <button id="submit-btn">Nộp bài</button>
                </div>
                <p id="question-text"></p>
                <div id="options-container"></div>
                <div id="feedback-container"></div>
                <div id="navigation-buttons">
                    <button id="next-btn" class="hidden">Câu tiếp theo</button>
                </div>
            </div>
    
            <div id="results-screen" class="hidden">
                <h2>Kết quả bài làm</h2>
                <p id="score-text"></p>
                <button id="restart-btn">Làm lại từ đầu</button>
                <div id="results-details"></div>
            </div>
        </div>
    </div>
    
    <div id="google_translate_element" style="position: fixed; bottom: 10px; right: 10px; z-index: 1000;"></div>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <script>
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({pageLanguage: 'vi', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
        }

        document.addEventListener('DOMContentLoaded', () => {
            const questionBank = [
                { question: "Ba hệ thống con (subsystems) chính cấu tạo nên một máy tính là gì?", options: ["CPU, Bàn phím, Màn hình", "CPU, Bộ nhớ chính, Hệ thống I/O", "ALU, Control Unit, RAM", "Ổ cứng, RAM, Chuột"], answer: 1, tip: "Hãy nhớ 3 thành phần cốt lõi: Bộ não (CPU), Nơi làm việc (Bộ nhớ chính), và Cổng giao tiếp (I/O)." },
                { question: "Thành phần nào trong CPU chịu trách nhiệm thực hiện các phép toán số học và logic?", options: ["Control Unit", "Registers", "ALU (Arithmetic Logic Unit)", "Program Counter"], answer: 2, tip: "'Arithmetic' là số học, 'Logic' là logic. ALU chính là viết tắt của hai chức năng này." },
                { question: "Thanh ghi (Register) nào trong CPU giữ địa chỉ của lệnh kế tiếp sẽ được thực thi?", options: ["Instruction Register (IR)", "Data Register (DR)", "Program Counter (PC)", "Accumulator (AC)"], answer: 2, tip: "'Program Counter' giống như một người 'đếm' xem chương trình đã chạy đến dòng lệnh nào." },
                { question: "Đặc điểm nào phân biệt RAM với ROM?", options: ["RAM là bộ nhớ không khả biến (non-volatile)", "RAM có thể đọc và ghi, còn ROM chủ yếu chỉ để đọc", "RAM chậm hơn ROM", "ROM được dùng làm bộ nhớ chính cho các ứng dụng"], answer: 1, tip: "RAM (Random Access Memory) là bộ nhớ truy cập ngẫu nhiên, cho phép cả đọc và ghi. ROM (Read-Only Memory) là bộ nhớ chỉ đọc." },
                { question: "Mục đích chính của bộ nhớ đệm (Cache Memory) là gì?", options: ["Lưu trữ vĩnh viễn hệ điều hành", "Tăng tốc độ truy cập đến dữ liệu thường dùng từ bộ nhớ chính", "Thay thế hoàn toàn bộ nhớ RAM", "Kết nối các thiết bị ngoại vi"], answer: 1, tip: "Cache giống như một ngăn tủ nhỏ chứa những món đồ bạn hay dùng nhất để lấy cho nhanh, thay vì phải vào kho lớn (RAM) để tìm." },
                { question: "Hệ thống Bus trong máy tính bao gồm ba loại chính nào?", options: ["USB, FireWire, HDMI", "Serial, Parallel, Optical", "Data Bus, Address Bus, Control Bus", "Internal, External, System"], answer: 2, tip: "Hãy tưởng tượng một con đường 3 làn: một làn chở địa chỉ (Address), một làn chở dữ liệu (Data), và một làn cho tín hiệu đèn giao thông (Control)." },
                { question: "Chu kỳ máy (Machine Cycle) của CPU bao gồm ba pha cơ bản nào theo đúng thứ tự?", options: ["Decode, Fetch, Execute", "Fetch, Execute, Decode", "Fetch, Decode, Execute", "Execute, Fetch, Decode"], answer: 2, tip: "Quy trình hợp lý: Lấy lệnh (Fetch), Hiểu lệnh (Decode), rồi mới làm theo lệnh (Execute)." },
                { question: "Kiến trúc máy tính nào sử dụng một tập lệnh lớn và phức tạp?", options: ["RISC (Reduced Instruction Set Computer)", "MIMD", "CISC (Complex Instruction Set Computer)", "SIMD"], answer: 2, tip: "C trong CISC là viết tắt của 'Complex' (phức tạp)." },
                { question: "Kỹ thuật nào cho phép CPU xử lý gối đầu các pha của nhiều lệnh khác nhau cùng một lúc để tăng hiệu suất?", options: ["Parallel Processing", "Pipelining", "DMA", "Multitasking"], answer: 1, tip: "Pipelining giống như một dây chuyền lắp ráp, mỗi công đoạn xử lý một sản phẩm khác nhau, giúp tăng tổng sản lượng." },
                { question: "Phương pháp nào cho phép một thiết bị I/O tốc độ cao truyền dữ liệu trực tiếp với bộ nhớ chính mà không cần sự can thiệp của CPU?", options: ["Programmed I/O", "Interrupt-driven I/O", "DMA (Direct Memory Access)", "Memory-mapped I/O"], answer: 2, tip: "DMA là 'truy cập bộ nhớ trực tiếp', nghĩa là đi thẳng đến bộ nhớ mà không cần qua 'trung gian' CPU." }
            ];
            while (questionBank.length < 100) {
                const index = questionBank.length + 1;
                questionBank.push({ question: `Đây là câu hỏi ví dụ số ${index}.`, options: [`Đáp án A của câu ${index}`, `Đáp án B`, `Đáp án C`, `Đáp án D`], answer: Math.floor(Math.random() * 4), tip: `Đây là mẹo ghi nhớ cho câu hỏi ${index}.`});
            }

            const startScreen = document.getElementById('start-screen');
            const quizScreen = document.getElementById('quiz-screen');
            const resultsScreen = document.getElementById('results-screen');
            
            const quizOptionBtns = document.querySelectorAll('.quiz-option-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-btn');
            const restartBtn = document.getElementById('restart-btn');

            const progressText = document.getElementById('progress-text');
            const questionText = document.getElementById('question-text');
            const optionsContainer = document.getElementById('options-container');
            const feedbackContainer = document.getElementById('feedback-container');
            const scoreText = document.getElementById('score-text');
            const resultsDetails = document.getElementById('results-details');

            let currentQuestions = [];
            let currentQuestionIndex = 0;
            let userAnswers = [];

            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            function startQuiz(questionCount) {
                shuffleArray(questionBank);
                currentQuestions = questionBank.slice(0, questionCount);
                currentQuestionIndex = 0;
                userAnswers = new Array(currentQuestions.length).fill(null);

                startScreen.classList.add('hidden');
                resultsScreen.classList.add('hidden');
                quizScreen.classList.remove('hidden');

                displayQuestion();
            }

            function displayQuestion() {
                feedbackContainer.innerHTML = '';
                optionsContainer.classList.remove('answered');
                nextBtn.classList.add('hidden');

                const question = currentQuestions[currentQuestionIndex];
                questionText.textContent = question.question;
                progressText.textContent = `Câu hỏi ${currentQuestionIndex + 1} / ${currentQuestions.length}`;
                optionsContainer.innerHTML = '';

                question.options.forEach((option, index) => {
                    const optionElement = document.createElement('div');
                    optionElement.classList.add('option');
                    optionElement.textContent = option;
                    optionElement.dataset.index = index;
                    optionElement.addEventListener('click', () => selectOption(index));
                    optionsContainer.appendChild(optionElement);
                });
            }

            function selectOption(selectedIndex) {
                optionsContainer.classList.add('answered');
                const question = currentQuestions[currentQuestionIndex];
                const isCorrect = selectedIndex === question.answer;

                userAnswers[currentQuestionIndex] = {
                    question: question.question,
                    options: question.options,
                    tip: question.tip,
                    chosenAnswer: selectedIndex,
                    correctAnswer: question.answer
                };
                
                const allOptions = optionsContainer.querySelectorAll('.option');
                const selectedOption = allOptions[selectedIndex];

                if (isCorrect) {
                    selectedOption.classList.add('correct');
                } else {
                    selectedOption.classList.add('incorrect');
                    allOptions[question.answer].classList.add('correct');
                    feedbackContainer.innerHTML = `<div class="memory-tip">💡 Mẹo ghi nhớ: ${question.tip}</div>`;
                }

                if (currentQuestionIndex < currentQuestions.length - 1) {
                    nextBtn.classList.remove('hidden');
                } else {
                    submitBtn.textContent = 'Xem Kết Quả';
                }
            }

            function handleNextQuestion() {
                currentQuestionIndex++;
                displayQuestion();
                if (currentQuestionIndex === currentQuestions.length - 1) {
                    nextBtn.classList.add('hidden');
                }
            }
            
            function showResults() {
                quizScreen.classList.add('hidden');
                resultsScreen.classList.remove('hidden');
                
                let score = 0;
                resultsDetails.innerHTML = '';

                for(let i=0; i < userAnswers.length; i++){
                    const answerData = userAnswers[i];
                    if(!answerData) continue; // Skip unanswered questions

                    const isCorrect = answerData.chosenAnswer === answerData.correctAnswer;
                    if(isCorrect) score++;

                    const resultItem = document.createElement('div');
                    resultItem.classList.add('result-item');
                    
                    const chosenText = answerData.options[answerData.chosenAnswer];
                    const correctText = answerData.options[answerData.correctAnswer];
                    
                    let answerHtml = `<p class="user-answer incorrect">Bạn chọn: ${chosenText}</p>
                                      <p class="correct-answer">Đáp án đúng: ${correctText}</p>
                                      <div class="memory-tip">💡 Mẹo ghi nhớ: ${answerData.tip}</div>`;
                    if(isCorrect){
                        answerHtml = `<p class="user-answer correct">Bạn chọn: ${chosenText}</p>`;
                    }

                    resultItem.innerHTML = `<p class="result-question">${i+1}. ${answerData.question}</p>${answerHtml}`;
                    resultsDetails.appendChild(resultItem);
                }

                const answeredCount = userAnswers.filter(a => a !== null).length;
                scoreText.textContent = `Bạn đã trả lời đúng ${score} / ${answeredCount} câu!`;
                submitBtn.textContent = 'Nộp bài';
            }
            
            quizOptionBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    startQuiz(parseInt(btn.dataset.count, 10));
                });
            });

            nextBtn.addEventListener('click', handleNextQuestion);
            submitBtn.addEventListener('click', () => {
                if (confirm('Bạn có chắc chắn muốn kết thúc bài làm và xem kết quả không?')) {
                    showResults();
                }
            });
            restartBtn.addEventListener('click', () => {
                resultsScreen.classList.add('hidden');
                startScreen.classList.remove('hidden');
            });
        });
    </script>
</body>
</html>
